{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { CardElement, useElements, useStripe } from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\nimport { Button, Card } from \"semantic-ui-react\";\nimport { useState } from \"react\";\nimport Router, { useRouter } from \"next/router\";\n\nconst UpdatePaymentPerSubscription = ({\n  subscription\n}) => {\n  const {\n    site\n  } = useRouter().query;\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const subscribeRequest = async (paymentMethod, subscriptionId) => {\n    const res = await axios.post(`/api/site-subscriptions/update-card/${subscriptionId}`, {\n      newPaymentMethod: paymentMethod\n    });\n    return res.data;\n  };\n\n  const handleSubmit = async event => {\n    // Block native form submission.\n    event.preventDefault();\n\n    if (!stripe || !elements) {\n      // Stripe.js has not loaded yet. Make sure to disable\n      // form submission until Stripe.js has loaded.\n      return;\n    } // Get a reference to a mounted CardElement. Elements knows how\n    // to find your CardElement because there can only ever be one of\n    // each type of element.\n\n\n    const cardElement = elements.getElement(CardElement); // Use your card Element with other Stripe.js APIs\n\n    const {\n      error,\n      paymentMethod\n    } = await stripe.createPaymentMethod({\n      type: \"card\",\n      card: cardElement\n    });\n\n    if (error) {\n      console.log(\"[error]\", error);\n    } else {\n      setLoading(true);\n      await subscribeRequest(paymentMethod, subscription.id);\n      Router.push(`/admin/${site}/account/sites`);\n    }\n  };\n\n  return /*#__PURE__*/_jsx(Card, {\n    children: loading ? /*#__PURE__*/_jsx(\"div\", {\n      children: \"loading...\"\n    }) : /*#__PURE__*/_jsxs(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsx(CardElement, {\n        style: {\n          padding: \"10px\"\n        },\n        options: {\n          style: {\n            base: {\n              fontSize: \"16px\",\n              color: \"#424770\",\n              \"::placeholder\": {\n                color: \"#aab7c4\"\n              }\n            },\n            invalid: {\n              color: \"#9e2146\"\n            }\n          }\n        }\n      }), /*#__PURE__*/_jsx(Button, {\n        attached: \"bottom\",\n        fluid: true,\n        type: \"submit\",\n        color: \"green\",\n        disabled: !stripe,\n        style: {\n          marginTop: \"10px\"\n        },\n        onClick: handleSubmit,\n        children: \"Update Payment Method\"\n      })]\n    })\n  });\n};\n\nexport { UpdatePaymentPerSubscription };","map":null,"metadata":{},"sourceType":"module"}