{"ast":null,"code":"import _regeneratorRuntime from \"/Users/rjb/Desktop/code/projects/rfp/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/rjb/Desktop/code/projects/rfp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useRouter } from \"next/router\";\nimport { buildClient } from \"../../../../api/build-client\";\nimport { useAuth } from \"../../../../hooks/use-auth\";\nimport { CurrentSubscription } from \"../../../../components/payment/CurrentSubscription\";\nimport Layout from \"../../../../components/layouts\";\nimport { Fragment } from \"react\";\n\nvar subscriptionDetails = function subscriptionDetails(_ref) {\n  var user = _ref.user,\n      sub = _ref.sub,\n      pay = _ref.pay;\n  var subscription = useRouter().query.subscription;\n\n  var renderIfAuth = function renderIfAuth() {\n    return /*#__PURE__*/_jsx(Layout, {\n      smallLeaderboard: true,\n      leaderboardData: {\n        header: \"\".concat(subscription, \" subscription details\"),\n        subHeader: \"id: \".concat(sub.id),\n        btnText: \"\",\n        btnPath: \"\",\n        dividerText: \"Update or Cancel\"\n      },\n      children: /*#__PURE__*/_jsx(Fragment, {\n        children: /*#__PURE__*/_jsx(CurrentSubscription, {\n          subscription: sub,\n          pay: pay,\n          site: subscription,\n          userOfSite: user.userOfSite\n        })\n      })\n    });\n  };\n\n  return useAuth({\n    user: user,\n    currentUrlSite: useRouter().query.site,\n    renderIfAuth: renderIfAuth\n  });\n};\n\nsubscriptionDetails.getInitialProps = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(context) {\n    var _yield$buildClient$ge, currentUser, user, _yield$buildClient$ge2, data, _yield$buildClient$ge3, subscription, sub, pay;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return buildClient(context).get(\"/api/users/currentuser\");\n\n          case 2:\n            _yield$buildClient$ge = _context.sent;\n            currentUser = _yield$buildClient$ge.data;\n            user = currentUser.currentUser;\n            _context.next = 7;\n            return buildClient(context).get(\"/api/site/\".concat(context.query.subscription));\n\n          case 7:\n            _yield$buildClient$ge2 = _context.sent;\n            data = _yield$buildClient$ge2.data;\n            _context.next = 11;\n            return buildClient(context).get(\"/api/site-subscriptions/subscription/\".concat(data.subscriptionId));\n\n          case 11:\n            _yield$buildClient$ge3 = _context.sent;\n            subscription = _yield$buildClient$ge3.data;\n            sub = subscription.subscription;\n            pay = subscription.paymentMethod;\n            console.log(sub, pay);\n            return _context.abrupt(\"return\", {\n              user: user,\n              sub: sub,\n              pay: pay\n            });\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport default subscriptionDetails;","map":null,"metadata":{},"sourceType":"module"}